# Indoor-UWB-positioning-drone
## 项目介绍
在室内对无人机通过UWB技术进行定位控制。

项目包括无人机顶层控制程序，树莓派转发UWB主站信息程序，UWB资料。
## UWB介绍
UWB就是需要有几个基站然后对一个标签进行测距最终就能定位标签的坐标。我们选用的是维特智能的一款UWB，它的主基站对几个次基站发出测距指令然后次基站的测距数据会返回到主机站然后主机站就能解算出标签的坐标。然后标签放在无人机上就可以知道飞机的实时位置。
## 对飞机平面定位控制
当然由于只有主机站能解算出坐标，而真正需要使用到这个坐标的是无人机，所以我们又接了一个树莓派，树莓派上连接了一个UWB和数传，UWB解算出来的数据就通过数传传到飞控上，这样飞机就能获取的当前的实时坐标。当我们需要将飞机自动飞向某个固定点时就预先用UWB放在指定点就知道了飞机的目标坐标。然后通过pid闭环控制就可以让飞机飞向某个点。当然我们只是让UWB作为平面的定位。
## 对飞机高度控制
高度的定位，我们采用的是光流加激光融合之后的高度数据，然后再用pid闭环就可以实现高度控制。
## 对飞机角度控制
而飞机在实际飞行过程中发现航向角在进过一段时间的飞行后，会有比较大的偏差，于是直接将飞控连接到上位机发现航向角即使在飞机静止的情况下也会偏，后来发现原来是磁罗盘收到磁干扰。那我们就直接不用磁罗盘靠加速度计计算出的航向角进行控制。起飞前航向角是一个方向起飞后发现偏差再进行纠正我们还是用了角度pid闭环。
